ARG REPO
FROM $REPO

ARG DOCKER_NAME
ENV DOCKER_NAME ${DOCKER_NAME}

USER root

ARG DOCKER_UID
ENV DOCKER_UID ${DOCKER_UID}

ARG DOCKER_GID
ENV DOCKER_GID ${DOCKER_GID}

ARG DOCKER_USERNAME
ENV DOCKER_USERNAME ${DOCKER_USERNAME}
ENV USER ${DOCKER_USERNAME}

# Add the user
RUN addgroup --gid ${DOCKER_GID} ${DOCKER_USERNAME}
RUN adduser --uid ${DOCKER_UID} --gid ${DOCKER_GID} --disabled-password --gecos '' ${DOCKER_USERNAME}
RUN adduser ${DOCKER_USERNAME} sudo
RUN echo '%sudo ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers

ENV HOME /home/${DOCKER_USERNAME}
WORKDIR ${HOME}

USER ${DOCKER_USERNAME}

ENTRYPOINT /bin/sh -c "while true; do sleep 10; done"
